Ã‹
    Ãš#Zi;
  Ã£                   Ã³X   â€” d dl Z d dlZd dlmZ d dlmZ d dlm Z  d dlm	Z	  G dâ€ d Â«      Z
y)Ã©    N)ÃšQueue)Ãš Options)Ãš
DumpMaster)Ãš
Interceptorc                   Ã³F   â€” e Zd ZdZdedededefdâ€Z d â€ Zdâ€ Z	d	â€ Z
d
e
fd
â€Zy)
ÃšProxyManagerz>
    Manages the mitmproxy instance in a separate thread.
    Ãš	gui_queueÃš
proxy_queueÃšhostÃšportc                 Ã³f   â€” || _         || _        || _        || _        d | _        d | _        d | _        y )N) r	   r
   r
   r   Ãš
_proxy_threadÃšmasterÃšloop)Ãšselfr	   r
   r
   r   s        ÃºSC:\Users\nsrin\OneDrive\Desktop\Hacking Tools\proxy-tool\Proxy_tool2\proxy\proxy.pyÃš__init__zProxyManager.__init__   s5   â‚¬ Ã˜"Ë†Å’Ã˜&Ë†Ã”Ã˜Ë†Å’	Ã˜Ë†Å’	Ã˜!Ë†Ã”Ã˜Ë†Å’
Ã˜Ë†Â	Ã³    c                 Ã³Å¾   â€” | j                   Âyt        j                  | j                  dÂ¬Â«      | _         | j                   j	                  Â«        y)z!Starts the proxy in a new thread.NT)ÃštargetÃšdaemon)r   Ãš	threadingÃšThreadÃš
_run_proxyÃšstartÂ©r   s    r   r   zProxyManager.start   s<   â‚¬ Ã 
Ã—
Ã‘
Ã
)Ã˜Ã¤&Ã—-Ã‘-Â°TÂ·_Â±_ÃˆTÃ”RË†Ã”Ã˜Ã—Ã‘Ã— Ã‘ Ã•"r   c                  Ã³   â€” y)zStops the proxy.NÂ© r   s    r   ÃšstopzProxyManager.stop   s   â‚¬ Ã r   c                 Ã³:  â€¡ â€” Ë† fdâ€}dâ€° _         	 t        j                  Â«       }t        j                  |Â«       |â€° _         â€° j                   j	                   |Â«       Â«       â€° j                  r0â€° j                  j                  râ€° j                  j                  Â«        â€° j                   r4â€° j                   j                  Â«       râ€° j                   j                  Â«        â€° j                   r4â€° j                   j                  Â«       sâ€° j                   j                  Â«        t        dÂ«       y# t
        t        j                  f$ r t        dÂ«       Y Å’Ã®w xY w# â€° j                  r0â€° j                  j                  râ€° j                  j                  Â«        â€° j                   r4â€° j                   j                  Â«       râ€° j                   j                  Â«        â€° j                   r4â€° j                   j                  Â«       sâ€° j                   j                  Â«        t        dÂ«       w xY w)z'The target method for the proxy thread.c            	   â€œ   Ã³L  â€¢K  â€” t        â€°j                  â€°j                  ddÂ¬Â«      } t         | ddÂ¬Â«      â€°_        t
        j                  Â«       â€°_         t        â€°j                  â€°j                  Â«      }â€°j                  j                  j                  |Â«       t        dâ€°j                  â€º dâ€°j                  â€º ÂÂ«       	 â€°j                  j                  Â«       Æ’ d {  â€“â€”â€   t
        j                   â€°j                  Â«      D Âcg c]&  }|t
        j"                  â€°j                  Â«      usÅ’%|â€˜Å’( }}|D ]  }|j%                  Â«        Å’ |rt
        j&                  |ddiÅ½Æ’ d {  â€“â€”â€   y y 7 Å’Å # t
        j                  $ r t        d Â«       Y Å’Â¨w xY wc c}w 7 Å’1# t
        j                   â€°j                  Â«      D Âcg c]&  }|t
        j"                  â€°j                  Â«      usÅ’%|â€˜Å’( nc c}w }}|D ]  }|j%                  Â«        Å’ |rt
        j&                  |ddiÅ½Æ’ d {  â€“â€”â€ 7   w w xY wÂ­w)	NT)Ãš
listen_hostÃš
listen_portÃšhttp2Ãšssl_insecureF)Ãšwith_termlogÃš
with_dumperzStarting proxy server on Ãš:zMitmproxy master run cancelled.Ãšreturn_exceptions)r   r
   r   r   r   Ãš asyncioÃšget_running_loopr   r   r	   r
   ÃšaddonsÃšaddÃšprintÃšrunÃšCancelledErrorÃš	all_tasksÃšcurrent_taskÃšcancelÃšgather)ÃšoptsÃšinterceptor_addonÃštÃštasksÃštaskr   s        â‚¬r   Ãšmainz%ProxyManager._run_proxy.<locals>.main&   sÃ‰  Ã¸Ã¨ Ã¸â‚¬ ÃœÃ˜ Å¸Iâ„¢IÃ˜ Å¸Iâ„¢IÃ˜Ã˜!Ã´	Ë†DÃ´ %Â TÂ¸Ãˆ5Ã”QË†DÅ’KÃœÃ—0Ã‘0Ã“2Ë†DÅ’IÃ¤ +Â¨DÂ¯NÂ©NÂ¸DÃ—<LÃ‘<LÃ“ MÃÃ˜ÂKâ€°KÃ—Ã‘Ã—"Ã‘"Ã#4Ã”5Ã¤Ã-Â¨dÂ¯iÂ©iÂ¨[Â¸Â¸$Â¿)Â¹)Â¸ÃEÃ”FÃ°
IÃ˜â€”kâ€˜kâ€”oâ€˜oÃ“'Ã—'Ã'Ã´
 %,Ã—$5Ã‘$5Â°dÂ·iÂ±iÃ”$@Ã“mÃ‘$@ËœqÃ€AÃŒWÃ—MaÃ‘MaÃbfÃ—bkÃ‘bkÃ“MlÃ’DlÅ¡Ã$@ÂÃmÃ›!ÂDÃ˜â€”Kâ€˜Kâ€¢MÃ° "Ã± Ãœ!Å¸.â„¢.Â¨%ÃHÃ€4Ã‘HÃ—HÃ‘HÃ° Ã° (Ã¹ÃœÃ—)Ã‘)Ã² 
9ÃœÃ7Ã–8Ã°
9Ã¼Ã² nÃ° IÃ¹Ã´
 %,Ã—$5Ã‘$5Â°dÂ·iÂ±iÃ”$@Ã“mÃ‘$@ËœqÃ€AÃŒWÃ—MaÃ‘MaÃbfÃ—bkÃ‘bkÃ“MlÃ’DlÅ¡Ã‘$@Ã¹Ã’mÂÃmÃ›!ÂDÃ˜â€”Kâ€˜Kâ€¢MÃ° "Ã± Ãœ!Å¸.â„¢.Â¨%ÃHÃ€4Ã‘HÃ—HÃ’HÃ° Ã¼sÅ    Æ’B:H$Ã‚>E( ÃƒE&ÃƒE( Ãƒ !H$Ã„&FÃ„(FÃ„,3H$Ã…FÃ… H$Ã…&E( Ã…(F	Ã†F Ã†F	Ã†	F Ã†H$Ã†"H!Ã†5&G!Ã‡G!Ã‡ 9H!ÃˆHÃˆ H!Ãˆ!H$NzProxy server shutting down.z!Proxy thread _run_proxy finished.)r   r*   Ãšnew_event_loopÃšset_event_loopÃšrun_until_completeÃšKeyboardInterruptr0   r.   r   Ãš runningÃšshutdownÃš
is_runningr   Ãš	is_closedÃšclose)r   r:   Ãšnew_loops   `  r   r   zProxyManager._run_proxy#   s`  Ã¸â‚¬ Ã´	IÃ°< Ë†Å’	Ã°	7ÃœÃ—-Ã‘-Ã“/Ë†HÃœÃ—"Ã‘"Â 8Ã”,Ã˜ Ë†DÅ’IÃ ÂIâ€°IÃ—(Ã‘(Â©Â«Ã”0Ã° Â{Å {ËœtÅ¸{â„¢{Ã—2Ã’2Ã˜â€”
â€˜
Ã—$Ã‘$Ã”&Ã˜ÂyÅ yËœTÅ¸Yâ„¢YÃ—1Ã‘1Ã”3Ã˜â€”	â€˜	â€”â€˜Ã” Ã˜ÂyÅ yÂ Â§Â¡Ã—!4Ã‘!4Ã”!6Ã˜â€”	â€˜	â€”â€˜Ã”!ÃœÃ5Ã•6Ã¸Ã´ "Â¤7Ã—#9Ã‘#9Ã:Ã² 	1ÃœÃ/Ã–0Ã°	1Ã»Ã° Â{Å {ËœtÅ¸{â„¢{Ã—2Ã’2Ã˜â€”
â€˜
Ã—$Ã‘$Ã”&Ã˜ÂyÅ yËœTÅ¸Yâ„¢YÃ—1Ã‘1Ã”3Ã˜â€”	â€˜	â€”â€˜Ã” Ã˜ÂyÅ yÂ Â§Â¡Ã—!4Ã‘!4Ã”!6Ã˜â€”	â€˜	â€”â€˜Ã”!ÃœÃ5Ã•6Ãºs%   ÂAD' Ã„'$EÃ…
E Ã…
EÃ…E Ã…C	HÃšvaluec                 Ã³Â®   â€” | j                   rI| j                  r<| j                  j                  | j                   j                  j                  d|Â«       yyy)z3Thread-safe way to call the addon's toggle command.zintercept.toggleN)r   r   Ãšcall_soon_threadsafeÃšcommandsÃšcall)r   rE   s     r   Ãštoggle_interceptzProxyManager.toggle_interceptV   s>   â‚¬ Ã 
Â;Å ;Ëœ4Å¸9Å¡9Ã˜ÂIâ€°IÃ—*Ã‘*Â¨4Â¯;Â©;Ã—+?Ã‘+?Ã—+DÃ‘+DÃFXÃZ_Ã•`Ã° %Ë†;r   N)
Ãš__name__Ãš
__module__Ãš__qualname__Ãš __doc__r   ÃšstrÃšintr   r   r   r   ÃšboolrJ   r   r   r   r   r   
   sF   â€ Ã±Ã° Â %Ã°  Â°eÃ°  Ã€3Ã°  ÃˆcÃ³  Ã²#Ã²
Ã²17Ã°faÂ dÃ´ ar   r   )
r*   r   Ãšqueuer   Ãšmitmproxy.optionsr   Ãšmitmproxy.tools.dumpr   Ãšproxy.interceptorr   r   r   r   r   Ãš<module>rV      s%   Ã°Ã› Ã› Ã Ã¥ %Ã +Ã¥ )Ã·OaÃ² Oar   
